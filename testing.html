<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/13.3.1/Tone.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/scribbletune/1.9.4/scribbletune.js"></script>
</head>
<body>
  <button id="new">NEW PATTERN</button>
</body>
<script>

// ['l','h','r']

function generatePattern(num_eigth_notes){
  var pattern = [];

  for(var b=0; b<num_eigth_notes;b++){
      if(Math.random() < 0.33){
        pattern.push('l');
      } else if(Math.random() < 0.5 ) {
        pattern.push('r') ;
      } else {
        pattern.push('h') ;
      }
  }
  
  return(pattern);
}

function convertPatternToBeatString(pattern, note){
  var string = '';
  for(var i=0; i<pattern.length; i++){
    pattern[i] == note
     
    if (pattern[i]==note) {
      string=string +'x'
    } else {
      string=string +'-'
    }
  }
  return string;
}


document.querySelector('#new').addEventListener('click', function(){

  var pattern = generatePattern(16)

  Tone.context.resume();
  Tone.Transport.stop();

  var ohClip = scribble.clip({
    pattern: convertPatternToBeatString(pattern, 'l'),
    sample: 'http://jdeleeuw.vassarcis.net/audiopref/wav/low.wav'
  });

  var ohClip2 = scribble.clip({
    pattern: convertPatternToBeatString(pattern, 'h'),
    sample: 'http://jdeleeuw.vassarcis.net/audiopref/wav/high.wav'
  });

  ohClip.start();
  ohClip2.start();
  Tone.Transport.start();    
})
</script>
</html>